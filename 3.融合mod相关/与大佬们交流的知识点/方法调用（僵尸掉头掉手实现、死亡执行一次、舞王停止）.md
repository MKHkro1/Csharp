方法调用：anim
血量低于某个值设置状态并更新anim


> [!Gy]
> losehead和losearm的粒子系统的script吗？

应该是在update或者takedamage里面能找到 --- 没有

在zombie类里面找找看
应该是有animator类型的一个字段

> [!gy]
> 僵尸掉手是多少血啊

僵尸的哪个方法是死亡后执行一次的啊，直接抓 die 方法的话僵尸死亡时会一直执行
这个应该是 die 之后执行一次随机然后直接创建僵尸实例

姜丝复活词条（？）

OnDestroy

> [!kb]
> 这个不能用
> 草，明白了
> 蓝飘飘的天才逻辑
> 如果僵尸在临界值（beforedying）
> 就一直执行扣血以及死亡的逻辑但他没检测僵尸是否正在死亡动画中
> 加上这个dying之后就正常了

![image.png](https://picgo18719498306.oss-cn-guangzhou.aliyuncs.com/20251005192033239.png)
这段代码是一个条件判断块，它检查僵尸实例（__instance）是否处于“濒死”状态（beforeDying）并且当前状态不是“死亡”状态（ZombieStatus.Dying）。
如果满足条件，则执行一系列操作来减少僵尸的生命值，并判断是否死亡。

具体步骤：
1. 将当前僵尸的生命值保存到变量theHealth中。
2. 根据僵尸的最大生命值（theMaxHealth）来计算生命值的减少量：
    - 如果最大生命值小于270，则减少1点生命。
    - 否则，减少的生命值为当前生命值减去（最大生命值除以270）的整数部分。
3. 更新僵尸的生命值为计算后的值（v4）。
4. 如果更新后的生命值小于等于0，则调用僵尸的Die方法（参数为0）使其死亡。
5. 更新僵尸的血量显示文本。

用于实现一种特殊的死亡机制（例如逐渐减少生命值直至死亡）。

这段代码实现了一个**"濒死状态持续扣血"的机制**。让我逐部分解释：

---

# 代码逻辑分析：

## 1. 条件检查
```csharp
if (__instance.beforeDying && __instance.theStatus != ZombieStatus.Dying)
```
- `beforeDying`：表示僵尸处于"濒死"状态
- `theStatus != ZombieStatus.Dying`：确保僵尸还没有正式进入死亡状态
- 只有同时满足这两个条件，才会执行扣血逻辑

## 2. 血量计算
```csharp
theHealth = __instance.theHealth;  // 保存当前血量
if (__instance.theMaxHealth < 270)
{
    v4 = theHealth - 1;  // 小血量僵尸：每次减1点血
}
else
{
    v4 = theHealth - __instance.theMaxHealth / 270;  // 大血量僵尸：按比例扣血
}
```

## 3. 应用伤害并检查死亡
```csharp
__instance.theHealth = v4;  // 更新血量
if (v4 <= 0)  // 如果血量归零或负数
{
    __instance.Die(0);  // 触发死亡
}
__instance.UpdateHealthText();  // 更新血条显示
```

---

# 功能总结：

这是一个**持续伤害效果**，类似于：
- **中毒**、**燃烧**、**流血**等持续掉血的 Debuff
- 僵尸在 `beforeDying` 状态下会不断掉血，直到真正死亡

## 扣血规则：
- **普通僵尸**（最大血量 < 270）：每秒掉 1 点血
- **精英/BOSS 僵尸**（最大血量 ≥ 270）：按最大血量的 1/270 比例掉血

---

# 应用场景推测：
这可能是游戏模组中添加的某种特殊机制，让僵尸在受到致命伤害后不会立即死亡，而是进入一个"缓慢死亡"的过程，给玩家更戏剧性的视觉效果。


白舞王的停止是在哪里的啊进化里面的一二三级

普通白舞王可以直接用碰撞箱，但我没在一级舞王里看到这个